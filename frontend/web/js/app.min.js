JQueryPlugin=function(t,e){if(void 0===this.pluginName||null===this.pluginName||""===this.pluginName)throw new Error('Static attribute "pluginName" must be set');this.destroyElementData(t),this.$element=t,this.options=$.extend({},this.defaultOptions(),e),this.init(),this.setElementData(t)},JQueryPlugin.prototype.destroyElementData=function(t){var e=t.data(this.pluginName);null!=e&&e.destroy()},JQueryPlugin.prototype.setElementData=function(t){t.data(this.pluginName,this)},JQueryPlugin.prototype.init=function(t){},JQueryPlugin.prototype.destroy=function(){this.$element.data(this.name,null)},JQueryPlugin.prototype.defaultOptions=function(){return{}},JQueryPlugin.addToJQuery=function(t,i){void 0!==$.fn[t]&&null!==$.fn[t]||($.fn[t]=function(e){if("object"==typeof(e=e||{}))return this.each(function(){var t=$.extend(!0,{},e);new i($(this),t)}),this;throw new Error("Invalid arguments for JQueryPlugin: "+e)})},ListEdit=function(t,e){JQueryPlugin.apply(this,arguments)},ListEdit.prototype=$.extend(Object.create(JQueryPlugin.prototype),{constructor:ListEdit,pluginName:"listEdit",init:function(){JQueryPlugin.prototype.init.apply(this,arguments);var e=this;this.$itemsContainer=this.$element.find(this.options.itemsContainerSelector),this.$templateItem=this.$element.find(this.options.templateItemSelector),this.$actionsContainer=this.$element.find(this.options.actionsContainerSelector),this._itemNextIndex=this.$element.find(this.options.itemSelector).length,this.initItems(),this.registerEvents(),this.options.actions.forEach(function(t){t.attachTo(e)}),this.options.itemActions.forEach(function(t){t.attachTo(e)})},defaultOptions:function(){return{itemsContainerSelector:".list-edit__items",templateItemSelector:".list-edit__item--template",itemSelector:".list-edit__item",itemCssClass:"list-edit__item",actionsContainerSelector:".list-edit__actions",actions:[],itemActions:[],itemPluginName:"listEditItem",itemPluginOptions:{}}},initItems:function(){var i=this;this.$element.find(this.options.itemSelector).each(function(t,e){i.initItem($(e),t),i.getItemPlugin($(e)).setPosition(t+1)})},initItem:function(t,e){t[this.options.itemPluginName](this.options.itemPluginOptions),this.getItemPlugin(t).attachTo(this,e)},getItemNextIndex:function(){var t=this._itemNextIndex;return this._itemNextIndex++,t},registerEvents:function(){},getNewItem:function(){var t=this.getItemNextIndex(),e=this.$templateItem.clone();return e.removeClass().addClass(this.options.itemCssClass),this.initItem(e,t),this.getItemPlugin(e).prepareNewItem(t),e},appendItem:function(t){var e=this.$element.find(this.options.itemSelector).length+1;this.getItemPlugin(t).setPosition(e),this.$itemsContainer.append(t)},deleteItem:function(t){t.remove(),this.updateItemsPosition()},updateItemsPosition:function(){var i=this;this.$element.find(this.options.itemSelector).each(function(t,e){i.getItemPlugin($(e)).setPosition(t+1)})},getItemPlugin:function(t){return t.data(this.options.itemPluginName)},getOptionsClone:function(){var t=$.extend({},this.options);return t.itemPluginOptions=$.extend({},t.itemPluginOptions),t.actions=t.actions.map(function(t){var e=t.options;return new t.constructor(e)}),t.itemActions=t.itemActions.map(function(t){var e=t.options;return new t.constructor(e)}),t}}),JQueryPlugin.addToJQuery(ListEdit.prototype.pluginName,ListEdit),ListEditExtension=function(t){this.options=$.extend({},this.defaultOptions(),t)},ListEditExtension.prototype.defaultOptions=function(){return{}},ListEditExtension.prototype.attachTo=function(t){this.listEdit=t,this.registerEvents()},ListEditExtension.prototype.registerEvents=function(){},ListEditActionCreate=function(t){ListEditExtension.apply(this,arguments)},ListEditActionCreate.prototype=$.extend(Object.create(ListEditExtension.prototype),{constructor:ListEditActionCreate,defaultOptions:function(){return{selector:""}},registerEvents:function(){var e=this;this.listEdit.$actionsContainer.find(this.options.selector).on("click",function(t){return t.preventDefault(),e.createNewItem(),!1})},createNewItem:function(){var t=this.listEdit.getNewItem();this.listEdit.appendItem(t)}}),ListEditActionDelete=function(t){ListEditExtension.apply(this,arguments)},ListEditActionDelete.prototype=$.extend(Object.create(ListEditExtension.prototype),{constructor:ListEditActionDelete,defaultOptions:function(){return{selector:""}},registerEvents:function(){var e=this;this.listEdit.$itemsContainer.on("click",this.options.selector,function(t){return t.preventDefault(),e.deleteItem($(this).closest(e.listEdit.options.itemSelector)),!1})},deleteItem:function(t){this.listEdit.deleteItem(t)}}),ListEditActionMove=function(t){ListEditExtension.apply(this,arguments)},ListEditActionMove.prototype=$.extend(Object.create(ListEditExtension.prototype),{constructor:ListEditActionMove,defaultOptions:function(){return{selector:""}},registerEvents:function(){var n=this;this.listEdit.$itemsContainer.sortable({handle:this.options.selector,axis:"y",cursor:"move",containment:"parent"}),this.listEdit.$itemsContainer.on("sortupdate",function(t,e){n.listEdit.$element.find(n.listEdit.options.itemSelector).not(".ui-sortable-placeholder").each(function(t,e){var i=n.listEdit.getItemPlugin($(e));i&&i.setPosition(t+1)})}),this.listEdit.$itemsContainer.on("click",this.options.selector,function(t){return t.preventDefault(),!1})}}),ListEditItem=function(t,e){JQueryPlugin.apply(this,arguments)},ListEditItem.prototype=$.extend(Object.create(JQueryPlugin.prototype),{constructor:ListEditItem,pluginName:"listEditItem",init:function(){JQueryPlugin.prototype.init.apply(this,arguments),this.initProperties()},initProperties:function(){this.uniqueIndex=null,this.position=null},initPlugins:function(){this.$element.find("select").each(function(t,e){var i=$(e),n=i.attr("data-s2-options"),o=i.attr("data-krajee-select2"),s=i.attr("id");n&&!i.data("select2")&&$.when(i.select2(window[o])).done(initS2Loading(s,n))})},attachTo:function(t,e){this.listEdit=t,this.uniqueIndex=e,this.registerEvents()},setPosition:function(t){this.position=t},prepareNewItem:function(){var t=this.$element,r=this.uniqueIndex;t.find(".select2.select2-container").remove(),t.find("input, textarea, select").each(function(t,e){var i=$(e),n=i.attr("name"),o=i.attr("id"),s=i.attr("data-select2-id");n=n.replace("[-1]","["+r+"]"),i.attr("name",n),o&&(o=o.replace("--1-","-"+r+"-"),i.attr("id",o)),s&&(s=s.replace("--1-","-"+r+"-"),i.attr("data-select2-id",s))}),t.find("label").each(function(t,e){var i=$(e).attr("for");i&&(i=i.replace("--1-","-"+r+"-"),$(e).attr("for",i))}),this.initPlugins()},registerEvents:function(){},getEventNamespace:function(){return"listItem"+this.uniqueIndex}}),JQueryPlugin.addToJQuery(ListEditItem.prototype.pluginName,ListEditItem),CalculateOsagoFormPeopleListEditItem=function(t,e){JQueryPlugin.apply(this,arguments)},CalculateOsagoFormPeopleListEditItem.prototype=$.extend(Object.create(ListEditItem.prototype),{constructor:CalculateOsagoFormPeopleListEditItem,pluginName:"calculateOsagoFormPeopleListEditItem",initProperties:function(){ListEditItem.prototype.initProperties.apply(this,arguments),this.$label=this.$element.find(".list-edit__item-label")},prepareNewItem:function(){ListEditItem.prototype.prepareNewItem.apply(this,arguments),$.fn.kvDatepicker.defaults.format="dd.mm.yyyy",$.fn.kvDatepicker.defaults.language="ru";var t=this.$element,s=this.uniqueIndex;t.find('[id *= "CalculateOsagoForm-people--1-"]').each(function(t,e){var i=$(e),n=i.attr("id"),o=i.find("input");n=n.replace("--1-","-"+s+"-"),i.attr("id",n.replace("--1-","-"+s+"-")),o.attr("data-datepicker-source",o.attr("data-datepicker-source").replace("--1-","-"+s+"-")),i.kvDatepicker()})},setPosition:function(t){ListEditItem.prototype.setPosition.apply(this,arguments),this.$label.text("Водитель #"+t)}}),JQueryPlugin.addToJQuery(CalculateOsagoFormPeopleListEditItem.prototype.pluginName,CalculateOsagoFormPeopleListEditItem),CalculateOsagoFormPeopleListEditActionDelete=function(t){ListEditExtension.apply(this,arguments)},CalculateOsagoFormPeopleListEditActionDelete.prototype=$.extend(Object.create(ListEditExtension.prototype),{constructor:CalculateOsagoFormPeopleListEditActionDelete,defaultOptions:function(){return{selector:""}},registerEvents:function(){var e=this;this.listEdit.$itemsContainer.on("click",this.options.selector,function(t){return t.preventDefault(),1<$(".list-edit__item").length&&e.deleteItem($(this).closest(e.listEdit.options.itemSelector)),!1})},deleteItem:function(t){this.listEdit.deleteItem(t)}});var allowSubmit,$form=$("#calculate-osago-form");$form.on("beforeValidate",function(){var t=$(".calculateosagoform-people-list-edit .list-edit__item");t.each(function(t,e){var i=$(e),n=i.find(".calculateosagoform-people-date_birth-input"),o=i.find(".calculateosagoform-driver_license_series-input"),s=i.find(".calculateosagoform-driver_license_number-input"),r=i.find(".calculateosagoform-date_begin_experience-input");n.val()?n.parent().parent().removeClass("has-error").find(".help-block").text(""):n.parent().parent().addClass("has-error").find(".help-block").text('Необходимо заполнить "Дата рождения"'),o.val()?o.parent().removeClass("has-error").find(".help-block").text(""):o.parent().addClass("has-error").find(".help-block").text('Необходимо заполнить "Серия водительского удостоверения"'),s.val()?s.parent().removeClass("has-error").find(".help-block").text(""):s.parent().addClass("has-error").find(".help-block").text('Необходимо заполнить "Номер водительского удостоверения"'),r.val()?r.parent().parent().removeClass("has-error").find(".help-block").text(""):r.parent().parent().addClass("has-error").find(".help-block").text('Необходимо заполнить "Дата начала стажа"')}),allowSubmit=!t.find(".has-error").length}),$form.on("beforeSubmit",function(){return allowSubmit});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJKUXVlcnlQbHVnaW4iLCIkZWxlbWVudCIsIm9wdGlvbnMiLCJ1bmRlZmluZWQiLCJ0aGlzIiwicGx1Z2luTmFtZSIsIkVycm9yIiwiZGVzdHJveUVsZW1lbnREYXRhIiwiJCIsImV4dGVuZCIsImRlZmF1bHRPcHRpb25zIiwiaW5pdCIsInNldEVsZW1lbnREYXRhIiwicHJvdG90eXBlIiwicGx1Z2luIiwiZGF0YSIsImRlc3Ryb3kiLCJuYW1lIiwiYWRkVG9KUXVlcnkiLCJQbHVnaW4iLCJmbiIsImVhY2giLCJpbnN0YW5jZU9wdGlvbnMiLCJMaXN0RWRpdCIsImFwcGx5IiwiYXJndW1lbnRzIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJzZWxmIiwiJGl0ZW1zQ29udGFpbmVyIiwiZmluZCIsIml0ZW1zQ29udGFpbmVyU2VsZWN0b3IiLCIkdGVtcGxhdGVJdGVtIiwidGVtcGxhdGVJdGVtU2VsZWN0b3IiLCIkYWN0aW9uc0NvbnRhaW5lciIsImFjdGlvbnNDb250YWluZXJTZWxlY3RvciIsIl9pdGVtTmV4dEluZGV4IiwiaXRlbVNlbGVjdG9yIiwibGVuZ3RoIiwiaW5pdEl0ZW1zIiwicmVnaXN0ZXJFdmVudHMiLCJhY3Rpb25zIiwiZm9yRWFjaCIsIml0ZW0iLCJhdHRhY2hUbyIsIml0ZW1BY3Rpb25zIiwiaXRlbUNzc0NsYXNzIiwiaXRlbVBsdWdpbk5hbWUiLCJpdGVtUGx1Z2luT3B0aW9ucyIsImkiLCJlbCIsImluaXRJdGVtIiwiZ2V0SXRlbVBsdWdpbiIsInNldFBvc2l0aW9uIiwiJGl0ZW0iLCJpbmRleCIsImdldEl0ZW1OZXh0SW5kZXgiLCJuZXh0SW5kZXgiLCJnZXROZXdJdGVtIiwiJG5ld0l0ZW0iLCJjbG9uZSIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJwcmVwYXJlTmV3SXRlbSIsImFwcGVuZEl0ZW0iLCJwb3NpdGlvbiIsImFwcGVuZCIsImRlbGV0ZUl0ZW0iLCJyZW1vdmUiLCJ1cGRhdGVJdGVtc1Bvc2l0aW9uIiwiZ2V0T3B0aW9uc0Nsb25lIiwibWFwIiwiYWN0aW9uIiwiYWN0aW9uT3B0aW9ucyIsIkxpc3RFZGl0RXh0ZW5zaW9uIiwibGlzdEVkaXQiLCJMaXN0RWRpdEFjdGlvbkNyZWF0ZSIsInNlbGVjdG9yIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJjcmVhdGVOZXdJdGVtIiwiTGlzdEVkaXRBY3Rpb25EZWxldGUiLCJjbG9zZXN0IiwiTGlzdEVkaXRBY3Rpb25Nb3ZlIiwic29ydGFibGUiLCJoYW5kbGUiLCJheGlzIiwiY3Vyc29yIiwiY29udGFpbm1lbnQiLCJldmVudCIsInVpIiwibm90IiwiTGlzdEVkaXRJdGVtIiwiaW5pdFByb3BlcnRpZXMiLCJ1bmlxdWVJbmRleCIsImluaXRQbHVnaW5zIiwiJGVsIiwiczJfb3B0aW9uc192YXIiLCJhdHRyIiwic2VsZWN0Ml92YXIiLCJpZCIsIndoZW4iLCJzZWxlY3QyIiwid2luZG93IiwiZG9uZSIsImluaXRTMkxvYWRpbmciLCJ2YWx1ZSIsImRhdGFTZWxlY3QySWQiLCJyZXBsYWNlIiwiYXR0ckZvciIsImdldEV2ZW50TmFtZXNwYWNlIiwiQ2FsY3VsYXRlT3NhZ29Gb3JtUGVvcGxlTGlzdEVkaXRJdGVtIiwiJGxhYmVsIiwia3ZEYXRlcGlja2VyIiwiZGVmYXVsdHMiLCJmb3JtYXQiLCJsYW5ndWFnZSIsImlucHV0IiwidGV4dCIsIkNhbGN1bGF0ZU9zYWdvRm9ybVBlb3BsZUxpc3RFZGl0QWN0aW9uRGVsZXRlIiwiYWxsb3dTdWJtaXQiLCIkZm9ybSIsIiRsaXN0RWRpdEl0ZW1zIiwiJGRhdGVCaXJ0aElucHV0IiwiJGRyaXZlckxpY2Vuc2VTZXJpZXNJbnB1dCIsIiRkcml2ZXJMaWNlbnNlTnVtYmVySW5wdXQiLCIkZGF0ZUJlZ2luRXhwZXJpZW5jZUlucHV0IiwidmFsIiwicGFyZW50Il0sIm1hcHBpbmdzIjoiQUFBQUEsYUFBZSxTQUFTQyxFQUFVQyxHQUNoQyxRQUF3QkMsSUFBcEJDLEtBQUtDLFlBQWdE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QTRCN0IsRUFBSW5FLEtBQUssbURBQ3JDaUcsRUFBNEI5QixFQUFJbkUsS0FBSyxtREFFcEM4RixFQUFnQkksTUFHakJKLEVBQWdCSyxTQUFTQSxTQUFTcEUsWUFBWSxhQUFhL0IsS0FBSyxlQUFleUYsS0FBSyxJQUZwRkssRUFBZ0JLLFNBQVNBLFNBQVNuRSxTQUFTLGFBQWFoQyxLQUFLLGVBQWV5RixLQUFLLHdDQUtoRk0sRUFBMEJHLE1BRzNCSCxFQUEwQkksU0FBU3BFLFlBQVksYUFBYS9CLEtBQUssZUFBZXlGLEtBQUssSUFGckZNLEVBQTBCSSxTQUFTbkUsU0FBUyxhQUFhaEMsS0FBSyxlQUFleUYsS0FBSyw0REFLakZPLEVBQTBCRSxNQUczQkYsRUFBMEJHLFNBQVNwRSxZQUFZLGFBQWEvQixLQUFLLGVBQWV5RixLQUFLLElBRnJGTyxFQUEwQkcsU0FBU25FLFNBQVMsYUFBYWhDLEtBQUssZUFBZXlGLEtBQUssNERBS2pGUSxFQUEwQkMsTUFHM0JELEVBQTBCRSxTQUFTQSxTQUFTcEUsWUFBWSxhQUFhL0IsS0FBSyxlQUFleUYsS0FBSyxJQUY5RlEsRUFBMEJFLFNBQVNBLFNBQVNuRSxTQUFTLGFBQWFoQyxLQUFLLGVBQWV5RixLQUFLLDhDQU1uR0UsYUFBZUUsRUFBZTdGLEtBQUssY0FBY1EsU0FHckRvRixNQUFNNUMsR0FBRyxlQUFnQixXQUNyQixPQUFPMkMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiSlF1ZXJ5UGx1Z2luID0gZnVuY3Rpb24oJGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICBpZiAodGhpcy5wbHVnaW5OYW1lID09PSB1bmRlZmluZWQgfHwgdGhpcy5wbHVnaW5OYW1lID09PSBudWxsIHx8IHRoaXMucGx1Z2luTmFtZSA9PT0gJycpXHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1N0YXRpYyBhdHRyaWJ1dGUgXCJwbHVnaW5OYW1lXCIgbXVzdCBiZSBzZXQnKTtcclxuXHJcbiAgdGhpcy5kZXN0cm95RWxlbWVudERhdGEoJGVsZW1lbnQpO1xyXG5cclxuICB0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XHJcbiAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIHRoaXMuZGVmYXVsdE9wdGlvbnMoKSwgb3B0aW9ucyk7XHJcblxyXG4gIHRoaXMuaW5pdCgpO1xyXG5cclxuICB0aGlzLnNldEVsZW1lbnREYXRhKCRlbGVtZW50KTtcclxufTtcclxuXHJcbkpRdWVyeVBsdWdpbi5wcm90b3R5cGUuZGVzdHJveUVsZW1lbnREYXRhID0gZnVuY3Rpb24oJGVsZW1lbnQpIHtcclxuICB2YXIgcGx1Z2luID0gJGVsZW1lbnQuZGF0YSh0aGlzLnBsdWdpbk5hbWUpO1xyXG4gIGlmIChwbHVnaW4gIT09IHVuZGVmaW5lZCAmJiBwbHVnaW4gIT09IG51bGwpIHtcclxuICAgIHBsdWdpbi5kZXN0cm95KCk7XHJcbiAgfVxyXG59O1xyXG5cclxuSlF1ZXJ5UGx1Z2luLnByb3RvdHlwZS5zZXRFbGVtZW50RGF0YSA9IGZ1bmN0aW9uKCRlbGVtZW50KSB7XHJcbiAgJGVsZW1lbnQuZGF0YSh0aGlzLnBsdWdpbk5hbWUsIHRoaXMpO1xyXG59O1xyXG5cclxuSlF1ZXJ5UGx1Z2luLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oJGVsZW1lbnQpIHtcclxuXHJcbn07XHJcblxyXG5KUXVlcnlQbHVnaW4ucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcclxuICB0aGlzLiRlbGVtZW50LmRhdGEodGhpcy5uYW1lLCBudWxsKTtcclxufTtcclxuXHJcbkpRdWVyeVBsdWdpbi5wcm90b3R5cGUuZGVmYXVsdE9wdGlvbnMgPSBmdW5jdGlvbigpIHtcclxuICByZXR1cm4ge307XHJcbn07XHJcblxyXG5KUXVlcnlQbHVnaW4uYWRkVG9KUXVlcnkgPSBmdW5jdGlvbihuYW1lLCBQbHVnaW4pIHtcclxuICBpZiAoJC5mbltuYW1lXSA9PT0gdW5kZWZpbmVkIHx8ICQuZm5bbmFtZV0gPT09IG51bGwpIHtcclxuICAgICQuZm5bbmFtZV0gPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuXHJcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgdmFyIGluc3RhbmNlT3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsIHt9LCBvcHRpb25zKTtcclxuXHJcbiAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBuZXcgUGx1Z2luKCQodGhpcyksIGluc3RhbmNlT3B0aW9ucyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhcmd1bWVudHMgZm9yIEpRdWVyeVBsdWdpbjogJyArIG9wdGlvbnMpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxufTtcclxuXHJcbkxpc3RFZGl0ID0gZnVuY3Rpb24oJGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICBKUXVlcnlQbHVnaW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufTtcclxuXHJcbkxpc3RFZGl0LnByb3RvdHlwZSA9ICQuZXh0ZW5kKE9iamVjdC5jcmVhdGUoSlF1ZXJ5UGx1Z2luLnByb3RvdHlwZSksIHtcclxuICBjb25zdHJ1Y3RvcjogTGlzdEVkaXQsXHJcbiAgcGx1Z2luTmFtZTogJ2xpc3RFZGl0JyxcclxuXHJcbiAgaW5pdDogZnVuY3Rpb24oKSB7XHJcbiAgICBKUXVlcnlQbHVnaW4ucHJvdG90eXBlLmluaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICB0aGlzLiRpdGVtc0NvbnRhaW5lciA9IHRoaXMuJGVsZW1lbnQuZmluZCh0aGlzLm9wdGlvbnMuaXRlbXNDb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICB0aGlzLiR0ZW1wbGF0ZUl0ZW0gPSB0aGlzLiRlbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLnRlbXBsYXRlSXRlbVNlbGVjdG9yKTtcclxuICAgIHRoaXMuJGFjdGlvbnNDb250YWluZXIgPSB0aGlzLiRlbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLmFjdGlvbnNDb250YWluZXJTZWxlY3Rvcik7XHJcblxyXG4gICAgdGhpcy5faXRlbU5leHRJbmRleCA9IHRoaXMuJGVsZW1lbnQuZmluZCh0aGlzLm9wdGlvbnMuaXRlbVNlbGVjdG9yKS5sZW5ndGg7XHJcblxyXG4gICAgdGhpcy5pbml0SXRlbXMoKTtcclxuICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcclxuXHJcbiAgICB0aGlzLm9wdGlvbnMuYWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgaXRlbS5hdHRhY2hUbyhzZWxmKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5vcHRpb25zLml0ZW1BY3Rpb25zLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICBpdGVtLmF0dGFjaFRvKHNlbGYpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgZGVmYXVsdE9wdGlvbnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXRlbXNDb250YWluZXJTZWxlY3RvcjogJy5saXN0LWVkaXRfX2l0ZW1zJyxcclxuICAgICAgdGVtcGxhdGVJdGVtU2VsZWN0b3I6ICcubGlzdC1lZGl0X19pdGVtLS10ZW1wbGF0ZScsXHJcbiAgICAgIGl0ZW1TZWxlY3RvcjogJy5saXN0LWVkaXRfX2l0ZW0nLFxyXG4gICAgICBpdGVtQ3NzQ2xhc3M6ICdsaXN0LWVkaXRfX2l0ZW0nLFxyXG4gICAgICBhY3Rpb25zQ29udGFpbmVyU2VsZWN0b3I6ICcubGlzdC1lZGl0X19hY3Rpb25zJyxcclxuICAgICAgYWN0aW9uczogW10sXHJcbiAgICAgIGl0ZW1BY3Rpb25zOiBbXSxcclxuICAgICAgaXRlbVBsdWdpbk5hbWU6ICdsaXN0RWRpdEl0ZW0nLFxyXG4gICAgICBpdGVtUGx1Z2luT3B0aW9uczoge31cclxuICAgIH07XHJcbiAgfSxcclxuXHJcbiAgaW5pdEl0ZW1zOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHRoaXMuJGVsZW1lbnQuZmluZCh0aGlzLm9wdGlvbnMuaXRlbVNlbGVjdG9yKS5lYWNoKGZ1bmN0aW9uKGksIGVsKSB7XHJcbiAgICAgIHNlbGYuaW5pdEl0ZW0oJChlbCksIGkpO1xyXG4gICAgICBzZWxmLmdldEl0ZW1QbHVnaW4oJChlbCkpLnNldFBvc2l0aW9uKGkrMSk7XHJcbiAgICB9KVxyXG4gIH0sXHJcblxyXG4gIGluaXRJdGVtOiBmdW5jdGlvbigkaXRlbSwgaW5kZXgpIHtcclxuICAgICRpdGVtW3RoaXMub3B0aW9ucy5pdGVtUGx1Z2luTmFtZV0odGhpcy5vcHRpb25zLml0ZW1QbHVnaW5PcHRpb25zKTtcclxuICAgIHRoaXMuZ2V0SXRlbVBsdWdpbigkaXRlbSkuYXR0YWNoVG8odGhpcywgaW5kZXgpO1xyXG4gIH0sXHJcblxyXG4gIGdldEl0ZW1OZXh0SW5kZXg6IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG5leHRJbmRleCA9IHRoaXMuX2l0ZW1OZXh0SW5kZXg7XHJcbiAgICB0aGlzLl9pdGVtTmV4dEluZGV4Kys7XHJcbiAgICByZXR1cm4gbmV4dEluZGV4O1xyXG4gIH0sXHJcblxyXG4gIHJlZ2lzdGVyRXZlbnRzOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgfSxcclxuXHJcbiAgZ2V0TmV3SXRlbTogZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgbmV4dEluZGV4ID0gdGhpcy5nZXRJdGVtTmV4dEluZGV4KCk7XHJcbiAgICB2YXIgJG5ld0l0ZW0gPSB0aGlzLiR0ZW1wbGF0ZUl0ZW0uY2xvbmUoKTtcclxuXHJcbiAgICAkbmV3SXRlbVxyXG4gICAgICAucmVtb3ZlQ2xhc3MoKVxyXG4gICAgICAuYWRkQ2xhc3ModGhpcy5vcHRpb25zLml0ZW1Dc3NDbGFzcyk7XHJcblxyXG4gICAgdGhpcy5pbml0SXRlbSgkbmV3SXRlbSwgbmV4dEluZGV4KTtcclxuICAgIHRoaXMuZ2V0SXRlbVBsdWdpbigkbmV3SXRlbSkucHJlcGFyZU5ld0l0ZW0obmV4dEluZGV4KTtcclxuXHJcbiAgICByZXR1cm4gJG5ld0l0ZW07XHJcbiAgfSxcclxuXHJcbiAgYXBwZW5kSXRlbTogZnVuY3Rpb24oJGl0ZW0pIHtcclxuICAgIHZhciBwb3NpdGlvbiA9IHRoaXMuJGVsZW1lbnQuZmluZCh0aGlzLm9wdGlvbnMuaXRlbVNlbGVjdG9yKS5sZW5ndGggKyAxO1xyXG4gICAgdGhpcy5nZXRJdGVtUGx1Z2luKCRpdGVtKS5zZXRQb3NpdGlvbihwb3NpdGlvbik7XHJcbiAgICB0aGlzLiRpdGVtc0NvbnRhaW5lci5hcHBlbmQoJGl0ZW0pO1xyXG4gIH0sXHJcblxyXG4gIGRlbGV0ZUl0ZW06IGZ1bmN0aW9uKCRpdGVtKSB7XHJcbiAgICAkaXRlbS5yZW1vdmUoKTtcclxuICAgIHRoaXMudXBkYXRlSXRlbXNQb3NpdGlvbigpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZUl0ZW1zUG9zaXRpb246IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy4kZWxlbWVudC5maW5kKHRoaXMub3B0aW9ucy5pdGVtU2VsZWN0b3IpLmVhY2goZnVuY3Rpb24oaSwgZWwpIHtcclxuICAgICAgc2VsZi5nZXRJdGVtUGx1Z2luKCQoZWwpKS5zZXRQb3NpdGlvbihpKzEpO1xyXG4gICAgfSlcclxuICB9LFxyXG5cclxuICBnZXRJdGVtUGx1Z2luOiBmdW5jdGlvbigkaXRlbSkge1xyXG4gICAgcmV0dXJuICRpdGVtLmRhdGEodGhpcy5vcHRpb25zLml0ZW1QbHVnaW5OYW1lKVxyXG4gIH0sXHJcblxyXG4gIGdldE9wdGlvbnNDbG9uZTogZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnMpO1xyXG4gICAgb3B0aW9ucy5pdGVtUGx1Z2luT3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBvcHRpb25zLml0ZW1QbHVnaW5PcHRpb25zKTtcclxuXHJcbiAgICBvcHRpb25zLmFjdGlvbnMgPSBvcHRpb25zLmFjdGlvbnMubWFwKGZ1bmN0aW9uKGFjdGlvbikge1xyXG4gICAgICB2YXIgYWN0aW9uT3B0aW9ucyA9IGFjdGlvbi5vcHRpb25zO1xyXG4gICAgICByZXR1cm4gbmV3IGFjdGlvbi5jb25zdHJ1Y3RvcihhY3Rpb25PcHRpb25zKTtcclxuICAgIH0pO1xyXG5cclxuICAgIG9wdGlvbnMuaXRlbUFjdGlvbnMgPSBvcHRpb25zLml0ZW1BY3Rpb25zLm1hcChmdW5jdGlvbihhY3Rpb24pIHtcclxuICAgICAgdmFyIGFjdGlvbk9wdGlvbnMgPSBhY3Rpb24ub3B0aW9ucztcclxuICAgICAgcmV0dXJuIG5ldyBhY3Rpb24uY29uc3RydWN0b3IoYWN0aW9uT3B0aW9ucyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gb3B0aW9ucztcclxuICB9XHJcbn0pO1xyXG5cclxuSlF1ZXJ5UGx1Z2luLmFkZFRvSlF1ZXJ5KExpc3RFZGl0LnByb3RvdHlwZS5wbHVnaW5OYW1lLCBMaXN0RWRpdCk7XHJcbkxpc3RFZGl0RXh0ZW5zaW9uID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCB0aGlzLmRlZmF1bHRPcHRpb25zKCksIG9wdGlvbnMpO1xyXG59O1xyXG5cclxuTGlzdEVkaXRFeHRlbnNpb24ucHJvdG90eXBlLmRlZmF1bHRPcHRpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHt9O1xyXG59O1xyXG5cclxuTGlzdEVkaXRFeHRlbnNpb24ucHJvdG90eXBlLmF0dGFjaFRvID0gZnVuY3Rpb24obGlzdEVkaXQpIHtcclxuICB0aGlzLmxpc3RFZGl0ID0gbGlzdEVkaXQ7XHJcbiAgdGhpcy5yZWdpc3RlckV2ZW50cygpO1xyXG59O1xyXG5cclxuTGlzdEVkaXRFeHRlbnNpb24ucHJvdG90eXBlLnJlZ2lzdGVyRXZlbnRzID0gZnVuY3Rpb24oKSB7XHJcblxyXG59O1xyXG5MaXN0RWRpdEFjdGlvbkNyZWF0ZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuICBMaXN0RWRpdEV4dGVuc2lvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59O1xyXG5cclxuTGlzdEVkaXRBY3Rpb25DcmVhdGUucHJvdG90eXBlID0gJC5leHRlbmQoT2JqZWN0LmNyZWF0ZShMaXN0RWRpdEV4dGVuc2lvbi5wcm90b3R5cGUpLCB7XHJcbiAgY29uc3RydWN0b3I6IExpc3RFZGl0QWN0aW9uQ3JlYXRlLFxyXG5cclxuICBkZWZhdWx0T3B0aW9uczogZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzZWxlY3RvcjogJydcclxuICAgIH07XHJcbiAgfSxcclxuXHJcbiAgcmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5saXN0RWRpdC4kYWN0aW9uc0NvbnRhaW5lci5maW5kKHRoaXMub3B0aW9ucy5zZWxlY3Rvcikub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHNlbGYuY3JlYXRlTmV3SXRlbSgpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBjcmVhdGVOZXdJdGVtOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciAkaXRlbSA9IHRoaXMubGlzdEVkaXQuZ2V0TmV3SXRlbSgpO1xyXG4gICAgdGhpcy5saXN0RWRpdC5hcHBlbmRJdGVtKCRpdGVtKTtcclxuICB9XHJcbn0pO1xyXG5MaXN0RWRpdEFjdGlvbkRlbGV0ZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuICBMaXN0RWRpdEV4dGVuc2lvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59O1xyXG5cclxuTGlzdEVkaXRBY3Rpb25EZWxldGUucHJvdG90eXBlID0gJC5leHRlbmQoT2JqZWN0LmNyZWF0ZShMaXN0RWRpdEV4dGVuc2lvbi5wcm90b3R5cGUpLCB7XHJcbiAgY29uc3RydWN0b3I6IExpc3RFZGl0QWN0aW9uRGVsZXRlLFxyXG5cclxuICBkZWZhdWx0T3B0aW9uczogZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzZWxlY3RvcjogJydcclxuICAgIH07XHJcbiAgfSxcclxuXHJcbiAgcmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIHRoaXMubGlzdEVkaXQuJGl0ZW1zQ29udGFpbmVyLm9uKCdjbGljaycsIHRoaXMub3B0aW9ucy5zZWxlY3RvciwgZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHNlbGYuZGVsZXRlSXRlbSgkKHRoaXMpLmNsb3Nlc3Qoc2VsZi5saXN0RWRpdC5vcHRpb25zLml0ZW1TZWxlY3RvcikpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBkZWxldGVJdGVtOiBmdW5jdGlvbigkaXRlbSkge1xyXG4gICAgdGhpcy5saXN0RWRpdC5kZWxldGVJdGVtKCRpdGVtKTtcclxuICB9XHJcbn0pO1xyXG5MaXN0RWRpdEFjdGlvbk1vdmUgPSBmdW5jdGlvbihvcHRpb25zKSB7XHJcbiAgTGlzdEVkaXRFeHRlbnNpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufTtcclxuXHJcbkxpc3RFZGl0QWN0aW9uTW92ZS5wcm90b3R5cGUgPSAkLmV4dGVuZChPYmplY3QuY3JlYXRlKExpc3RFZGl0RXh0ZW5zaW9uLnByb3RvdHlwZSksIHtcclxuICBjb25zdHJ1Y3RvcjogTGlzdEVkaXRBY3Rpb25Nb3ZlLFxyXG5cclxuICBkZWZhdWx0T3B0aW9uczogZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzZWxlY3RvcjogJydcclxuICAgIH07XHJcbiAgfSxcclxuXHJcbiAgcmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5saXN0RWRpdC4kaXRlbXNDb250YWluZXIuc29ydGFibGUoe1xyXG4gICAgICBoYW5kbGU6IHRoaXMub3B0aW9ucy5zZWxlY3RvcixcclxuICAgICAgYXhpczogJ3knLFxyXG4gICAgICBjdXJzb3I6ICdtb3ZlJyxcclxuICAgICAgY29udGFpbm1lbnQ6ICdwYXJlbnQnXHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmxpc3RFZGl0LiRpdGVtc0NvbnRhaW5lci5vbignc29ydHVwZGF0ZScsIGZ1bmN0aW9uIChldmVudCwgdWkpIHtcclxuICAgICAgc2VsZi5saXN0RWRpdC4kZWxlbWVudFxyXG4gICAgICAgIC5maW5kKHNlbGYubGlzdEVkaXQub3B0aW9ucy5pdGVtU2VsZWN0b3IpXHJcbiAgICAgICAgLm5vdCgnLnVpLXNvcnRhYmxlLXBsYWNlaG9sZGVyJylcclxuICAgICAgICAuZWFjaChmdW5jdGlvbihpLCBlbCkge1xyXG4gICAgICAgICAgdmFyIHBsdWdpbiA9IHNlbGYubGlzdEVkaXQuZ2V0SXRlbVBsdWdpbigkKGVsKSk7XHJcbiAgICAgICAgICBpZiAoISFwbHVnaW4pXHJcbiAgICAgICAgICAgIHBsdWdpbi5zZXRQb3NpdGlvbihpKzEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5saXN0RWRpdC4kaXRlbXNDb250YWluZXIub24oJ2NsaWNrJywgdGhpcy5vcHRpb25zLnNlbGVjdG9yLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufSk7XHJcbkxpc3RFZGl0SXRlbSA9IGZ1bmN0aW9uKCRlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgSlF1ZXJ5UGx1Z2luLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn07XHJcblxyXG5MaXN0RWRpdEl0ZW0ucHJvdG90eXBlID0gJC5leHRlbmQoT2JqZWN0LmNyZWF0ZShKUXVlcnlQbHVnaW4ucHJvdG90eXBlKSwge1xyXG4gIGNvbnN0cnVjdG9yOiBMaXN0RWRpdEl0ZW0sXHJcbiAgcGx1Z2luTmFtZTogJ2xpc3RFZGl0SXRlbScsXHJcblxyXG4gIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgSlF1ZXJ5UGx1Z2luLnByb3RvdHlwZS5pbml0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblxyXG4gICAgdGhpcy5pbml0UHJvcGVydGllcygpO1xyXG4gIH0sXHJcblxyXG4gIGluaXRQcm9wZXJ0aWVzOiBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMudW5pcXVlSW5kZXggPSBudWxsO1xyXG4gICAgdGhpcy5wb3NpdGlvbiA9IG51bGw7XHJcbiAgfSxcclxuXHJcbiAgaW5pdFBsdWdpbnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy4kZWxlbWVudC5maW5kKCdzZWxlY3QnKS5lYWNoKGZ1bmN0aW9uKGksIGVsKXtcclxuICAgICAgdmFyICRlbCA9ICQoZWwpO1xyXG4gICAgICB2YXIgczJfb3B0aW9uc192YXIgPSAkZWwuYXR0cignZGF0YS1zMi1vcHRpb25zJyk7XHJcbiAgICAgIHZhciBzZWxlY3QyX3ZhciA9ICRlbC5hdHRyKCdkYXRhLWtyYWplZS1zZWxlY3QyJyk7XHJcbiAgICAgIHZhciBpZCA9ICRlbC5hdHRyKCdpZCcpO1xyXG5cclxuICAgICAgaWYgKCEhczJfb3B0aW9uc192YXIgJiYgISRlbC5kYXRhKCdzZWxlY3QyJykpIHtcclxuICAgICAgICAkLndoZW4oJGVsLnNlbGVjdDIod2luZG93W3NlbGVjdDJfdmFyXSkpLmRvbmUoaW5pdFMyTG9hZGluZyhpZCwgczJfb3B0aW9uc192YXIpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgYXR0YWNoVG86IGZ1bmN0aW9uKGxpc3RFZGl0LCB1bmlxdWVJbmRleCkge1xyXG4gICAgdGhpcy5saXN0RWRpdCA9IGxpc3RFZGl0O1xyXG4gICAgdGhpcy51bmlxdWVJbmRleCA9IHVuaXF1ZUluZGV4O1xyXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50cygpO1xyXG4gIH0sXHJcblxyXG4gIHNldFBvc2l0aW9uOiBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgdGhpcy5wb3NpdGlvbiA9IHZhbHVlO1xyXG4gIH0sXHJcblxyXG4gIHByZXBhcmVOZXdJdGVtOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciAkaXRlbSA9IHRoaXMuJGVsZW1lbnQ7XHJcbiAgICB2YXIgaW5kZXg9IHRoaXMudW5pcXVlSW5kZXg7XHJcbiAgICAkaXRlbS5maW5kKCcuc2VsZWN0Mi5zZWxlY3QyLWNvbnRhaW5lcicpLnJlbW92ZSgpO1xyXG5cclxuICAgICRpdGVtLmZpbmQoJ2lucHV0LCB0ZXh0YXJlYSwgc2VsZWN0JykuZWFjaChmdW5jdGlvbihpLCBlbCl7XHJcbiAgICAgIHZhciAkZWwgPSAkKGVsKTtcclxuICAgICAgdmFyIG5hbWUgPSAkZWwuYXR0cignbmFtZScpO1xyXG4gICAgICB2YXIgaWQgPSAkZWwuYXR0cignaWQnKTtcclxuICAgICAgdmFyIGRhdGFTZWxlY3QySWQgPSAkZWwuYXR0cignZGF0YS1zZWxlY3QyLWlkJyk7XHJcblxyXG4gICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKCdbLTFdJywgJ1snK2luZGV4KyddJyk7XHJcbiAgICAgICRlbC5hdHRyKCduYW1lJywgbmFtZSk7XHJcbiAgICAgIGlmICghIWlkKSB7XHJcbiAgICAgICAgaWQgPSBpZC5yZXBsYWNlKCctLTEtJywgJy0nK2luZGV4KyctJyk7XHJcbiAgICAgICAgJGVsLmF0dHIoJ2lkJywgaWQpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghIWRhdGFTZWxlY3QySWQpIHtcclxuICAgICAgICBkYXRhU2VsZWN0MklkID0gZGF0YVNlbGVjdDJJZC5yZXBsYWNlKCctLTEtJywgJy0nK2luZGV4KyctJyk7XHJcbiAgICAgICAgJGVsLmF0dHIoJ2RhdGEtc2VsZWN0Mi1pZCcsIGRhdGFTZWxlY3QySWQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgICRpdGVtLmZpbmQoJ2xhYmVsJykuZWFjaChmdW5jdGlvbihpLCBlbCl7XHJcbiAgICAgIHZhciBhdHRyRm9yID0gJChlbCkuYXR0cignZm9yJyk7XHJcbiAgICAgIGlmICghIWF0dHJGb3IpIHtcclxuICAgICAgICBhdHRyRm9yID0gYXR0ckZvci5yZXBsYWNlKCctLTEtJywgJy0nK2luZGV4KyctJyk7XHJcbiAgICAgICAgJChlbCkuYXR0cignZm9yJywgYXR0ckZvcik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuaW5pdFBsdWdpbnMoKTtcclxuICB9LFxyXG5cclxuICByZWdpc3RlckV2ZW50czogZnVuY3Rpb24oKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIGdldEV2ZW50TmFtZXNwYWNlOiBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiAnbGlzdEl0ZW0nICsgdGhpcy51bmlxdWVJbmRleDtcclxuICB9XHJcbn0pO1xyXG5cclxuSlF1ZXJ5UGx1Z2luLmFkZFRvSlF1ZXJ5KExpc3RFZGl0SXRlbS5wcm90b3R5cGUucGx1Z2luTmFtZSwgTGlzdEVkaXRJdGVtKTtcclxuXHJcbkNhbGN1bGF0ZU9zYWdvRm9ybVBlb3BsZUxpc3RFZGl0SXRlbSA9IGZ1bmN0aW9uKCRlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICBKUXVlcnlQbHVnaW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufTtcclxuXHJcbkNhbGN1bGF0ZU9zYWdvRm9ybVBlb3BsZUxpc3RFZGl0SXRlbS5wcm90b3R5cGUgPSAkLmV4dGVuZChPYmplY3QuY3JlYXRlKExpc3RFZGl0SXRlbS5wcm90b3R5cGUpLCB7XHJcbiAgICBjb25zdHJ1Y3RvcjogQ2FsY3VsYXRlT3NhZ29Gb3JtUGVvcGxlTGlzdEVkaXRJdGVtLFxyXG4gICAgcGx1Z2luTmFtZTogJ2NhbGN1bGF0ZU9zYWdvRm9ybVBlb3BsZUxpc3RFZGl0SXRlbScsXHJcblxyXG4gICAgaW5pdFByb3BlcnRpZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIExpc3RFZGl0SXRlbS5wcm90b3R5cGUuaW5pdFByb3BlcnRpZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuXHJcbiAgICAgICAgdGhpcy4kbGFiZWwgPSB0aGlzLiRlbGVtZW50LmZpbmQoJy5saXN0LWVkaXRfX2l0ZW0tbGFiZWwnKTtcclxuICAgIH0sXHJcblxyXG4gICAgcHJlcGFyZU5ld0l0ZW06IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIExpc3RFZGl0SXRlbS5wcm90b3R5cGUucHJlcGFyZU5ld0l0ZW0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuXHJcbiAgICAgICAgLy9UT0RPOiDQv9C+0LrQsCDRgtCw0LrQvtC5INC60L7RgdGC0YvQu9GMINC90LAg0LjQt9C80LXQvdC10L3QuNC1INGP0LfRi9C60LAg0Lgg0LTQsNGC0Ysg0LIg0L/RgNC10YDQtdC+0L/RgNC10LTQtdC70LXQvdC40Y/RhSBkYXRlcGlja2VyJ9CwXHJcbiAgICAgICAgJC5mbi5rdkRhdGVwaWNrZXIuZGVmYXVsdHMuZm9ybWF0ID0gJ2RkLm1tLnl5eXknO1xyXG4gICAgICAgICQuZm4ua3ZEYXRlcGlja2VyLmRlZmF1bHRzLmxhbmd1YWdlID0gJ3J1JztcclxuXHJcbiAgICAgICAgdmFyICRpdGVtID0gdGhpcy4kZWxlbWVudDtcclxuICAgICAgICB2YXIgaW5kZXg9IHRoaXMudW5pcXVlSW5kZXg7XHJcblxyXG4gICAgICAgICRpdGVtLmZpbmQoJ1tpZCAqPSBcIkNhbGN1bGF0ZU9zYWdvRm9ybS1wZW9wbGUtLTEtXCJdJykuZWFjaChmdW5jdGlvbihpLCBlbCl7XHJcbiAgICAgICAgICAgIHZhciAkZWwgPSAkKGVsKTtcclxuICAgICAgICAgICAgdmFyIGlkID0gJGVsLmF0dHIoJ2lkJyk7XHJcbiAgICAgICAgICAgIHZhciBpbnB1dCA9ICRlbC5maW5kKCdpbnB1dCcpO1xyXG5cclxuICAgICAgICAgICAgaWQgPSBpZC5yZXBsYWNlKCctLTEtJywgJy0nK2luZGV4KyctJyk7XHJcbiAgICAgICAgICAgICRlbC5hdHRyKCdpZCcsIGlkLnJlcGxhY2UoJy0tMS0nLCAnLScraW5kZXgrJy0nKSk7XHJcbiAgICAgICAgICAgIGlucHV0LmF0dHIoJ2RhdGEtZGF0ZXBpY2tlci1zb3VyY2UnLCBpbnB1dC5hdHRyKCdkYXRhLWRhdGVwaWNrZXItc291cmNlJykucmVwbGFjZSgnLS0xLScsICctJytpbmRleCsnLScpKTtcclxuICAgICAgICAgICAgJGVsLmt2RGF0ZXBpY2tlcigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRQb3NpdGlvbjogZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICBMaXN0RWRpdEl0ZW0ucHJvdG90eXBlLnNldFBvc2l0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgdGhpcy4kbGFiZWwudGV4dCgn0JLQvtC00LjRgtC10LvRjCAjJyt2YWx1ZSk7XHJcbiAgICB9LFxyXG59KTtcclxuXHJcbkpRdWVyeVBsdWdpbi5hZGRUb0pRdWVyeShDYWxjdWxhdGVPc2Fnb0Zvcm1QZW9wbGVMaXN0RWRpdEl0ZW0ucHJvdG90eXBlLnBsdWdpbk5hbWUsIENhbGN1bGF0ZU9zYWdvRm9ybVBlb3BsZUxpc3RFZGl0SXRlbSk7XHJcbkNhbGN1bGF0ZU9zYWdvRm9ybVBlb3BsZUxpc3RFZGl0QWN0aW9uRGVsZXRlID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgTGlzdEVkaXRFeHRlbnNpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufTtcclxuXHJcbkNhbGN1bGF0ZU9zYWdvRm9ybVBlb3BsZUxpc3RFZGl0QWN0aW9uRGVsZXRlLnByb3RvdHlwZSA9ICQuZXh0ZW5kKE9iamVjdC5jcmVhdGUoTGlzdEVkaXRFeHRlbnNpb24ucHJvdG90eXBlKSwge1xyXG4gICAgY29uc3RydWN0b3I6IENhbGN1bGF0ZU9zYWdvRm9ybVBlb3BsZUxpc3RFZGl0QWN0aW9uRGVsZXRlLFxyXG5cclxuICAgIGRlZmF1bHRPcHRpb25zOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzZWxlY3RvcjogJydcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuXHJcbiAgICByZWdpc3RlckV2ZW50czogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICB0aGlzLmxpc3RFZGl0LiRpdGVtc0NvbnRhaW5lci5vbignY2xpY2snLCB0aGlzLm9wdGlvbnMuc2VsZWN0b3IsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCQoJy5saXN0LWVkaXRfX2l0ZW0nKS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmRlbGV0ZUl0ZW0oJCh0aGlzKS5jbG9zZXN0KHNlbGYubGlzdEVkaXQub3B0aW9ucy5pdGVtU2VsZWN0b3IpKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBkZWxldGVJdGVtOiBmdW5jdGlvbigkaXRlbSkge1xyXG4gICAgICAgIHRoaXMubGlzdEVkaXQuZGVsZXRlSXRlbSgkaXRlbSk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxudmFyICRmb3JtID0gJCgnI2NhbGN1bGF0ZS1vc2Fnby1mb3JtJyksXHJcbiAgICBhbGxvd1N1Ym1pdDtcclxuXHJcbiRmb3JtLm9uKCdiZWZvcmVWYWxpZGF0ZScsIGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciAkbGlzdEVkaXRJdGVtcyA9ICQoJy5jYWxjdWxhdGVvc2Fnb2Zvcm0tcGVvcGxlLWxpc3QtZWRpdCAubGlzdC1lZGl0X19pdGVtJyk7XHJcblxyXG4gICAgJGxpc3RFZGl0SXRlbXMuZWFjaChmdW5jdGlvbiAoaSwgZWwpIHtcclxuICAgICAgICB2YXIgJGVsID0gJChlbCksXHJcbiAgICAgICAgICAgICRkYXRlQmlydGhJbnB1dCA9ICRlbC5maW5kKCcuY2FsY3VsYXRlb3NhZ29mb3JtLXBlb3BsZS1kYXRlX2JpcnRoLWlucHV0JyksXHJcbiAgICAgICAgICAgICRkcml2ZXJMaWNlbnNlU2VyaWVzSW5wdXQgPSAkZWwuZmluZCgnLmNhbGN1bGF0ZW9zYWdvZm9ybS1kcml2ZXJfbGljZW5zZV9zZXJpZXMtaW5wdXQnKSxcclxuICAgICAgICAgICAgJGRyaXZlckxpY2Vuc2VOdW1iZXJJbnB1dCA9ICRlbC5maW5kKCcuY2FsY3VsYXRlb3NhZ29mb3JtLWRyaXZlcl9saWNlbnNlX251bWJlci1pbnB1dCcpLFxyXG4gICAgICAgICAgICAkZGF0ZUJlZ2luRXhwZXJpZW5jZUlucHV0ID0gJGVsLmZpbmQoJy5jYWxjdWxhdGVvc2Fnb2Zvcm0tZGF0ZV9iZWdpbl9leHBlcmllbmNlLWlucHV0Jyk7XHJcblxyXG4gICAgICAgIGlmICghJGRhdGVCaXJ0aElucHV0LnZhbCgpKSB7XHJcbiAgICAgICAgICAgICRkYXRlQmlydGhJbnB1dC5wYXJlbnQoKS5wYXJlbnQoKS5hZGRDbGFzcygnaGFzLWVycm9yJykuZmluZCgnLmhlbHAtYmxvY2snKS50ZXh0KCfQndC10L7QsdGF0L7QtNC40LzQviDQt9Cw0L/QvtC70L3QuNGC0YwgXCLQlNCw0YLQsCDRgNC+0LbQtNC10L3QuNGPXCInKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkZGF0ZUJpcnRoSW5wdXQucGFyZW50KCkucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ2hhcy1lcnJvcicpLmZpbmQoJy5oZWxwLWJsb2NrJykudGV4dCgnJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoISRkcml2ZXJMaWNlbnNlU2VyaWVzSW5wdXQudmFsKCkpIHtcclxuICAgICAgICAgICAgJGRyaXZlckxpY2Vuc2VTZXJpZXNJbnB1dC5wYXJlbnQoKS5hZGRDbGFzcygnaGFzLWVycm9yJykuZmluZCgnLmhlbHAtYmxvY2snKS50ZXh0KCfQndC10L7QsdGF0L7QtNC40LzQviDQt9Cw0L/QvtC70L3QuNGC0YwgXCLQodC10YDQuNGPINCy0L7QtNC40YLQtdC70YzRgdC60L7Qs9C+INGD0LTQvtGB0YLQvtCy0LXRgNC10L3QuNGPXCInKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkZHJpdmVyTGljZW5zZVNlcmllc0lucHV0LnBhcmVudCgpLnJlbW92ZUNsYXNzKCdoYXMtZXJyb3InKS5maW5kKCcuaGVscC1ibG9jaycpLnRleHQoJycpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCEkZHJpdmVyTGljZW5zZU51bWJlcklucHV0LnZhbCgpKSB7XHJcbiAgICAgICAgICAgICRkcml2ZXJMaWNlbnNlTnVtYmVySW5wdXQucGFyZW50KCkuYWRkQ2xhc3MoJ2hhcy1lcnJvcicpLmZpbmQoJy5oZWxwLWJsb2NrJykudGV4dCgn0J3QtdC+0LHRhdC+0LTQuNC80L4g0LfQsNC/0L7Qu9C90LjRgtGMIFwi0J3QvtC80LXRgCDQstC+0LTQuNGC0LXQu9GM0YHQutC+0LPQviDRg9C00L7RgdGC0L7QstC10YDQtdC90LjRj1wiJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJGRyaXZlckxpY2Vuc2VOdW1iZXJJbnB1dC5wYXJlbnQoKS5yZW1vdmVDbGFzcygnaGFzLWVycm9yJykuZmluZCgnLmhlbHAtYmxvY2snKS50ZXh0KCcnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghJGRhdGVCZWdpbkV4cGVyaWVuY2VJbnB1dC52YWwoKSkge1xyXG4gICAgICAgICAgICAkZGF0ZUJlZ2luRXhwZXJpZW5jZUlucHV0LnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdoYXMtZXJyb3InKS5maW5kKCcuaGVscC1ibG9jaycpLnRleHQoJ9Cd0LXQvtCx0YXQvtC00LjQvNC+INC30LDQv9C+0LvQvdC40YLRjCBcItCU0LDRgtCwINC90LDRh9Cw0LvQsCDRgdGC0LDQttCwXCInKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkZGF0ZUJlZ2luRXhwZXJpZW5jZUlucHV0LnBhcmVudCgpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdoYXMtZXJyb3InKS5maW5kKCcuaGVscC1ibG9jaycpLnRleHQoJycpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGFsbG93U3VibWl0ID0gISRsaXN0RWRpdEl0ZW1zLmZpbmQoJy5oYXMtZXJyb3InKS5sZW5ndGg7XHJcbn0pO1xyXG5cclxuJGZvcm0ub24oJ2JlZm9yZVN1Ym1pdCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiBhbGxvd1N1Ym1pdDtcclxufSk7Il19
